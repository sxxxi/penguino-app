


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > RemoteControlScreenKt</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">com.penguino.ui.screens</a>
</div>

<h1>Coverage Summary for Class: RemoteControlScreenKt (com.penguino.ui.screens)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">RemoteControlScreenKt</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/63)
  </span>
</td>
</tr>
  <tr>
    <td class="name">RemoteControlScreenKt$PreviewRcScreen$1</td>
  </tr>
  <tr>
    <td class="name">RemoteControlScreenKt$RemoteControlScreen$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">RemoteControlScreenKt$RemoteControlScreen$10$2$1$1$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">RemoteControlScreenKt$RemoteControlScreen$10$2$1$2$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">RemoteControlScreenKt$RemoteControlScreen$10$2$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">RemoteControlScreenKt$RemoteControlScreen$12</td>
  </tr>
  <tr>
    <td class="name">RemoteControlScreenKt$RemoteControlScreen$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">RemoteControlScreenKt$RemoteControlScreen$3</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">RemoteControlScreenKt$RemoteControlScreen$4</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">RemoteControlScreenKt$RemoteControlScreen$5</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">RemoteControlScreenKt$RemoteControlScreen$6</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">RemoteControlScreenKt$RemoteControlScreen$7</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/7)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">RemoteControlScreenKt$RemoteControlScreen$7$WhenMappings</td>
  </tr>
  <tr>
    <td class="name">RemoteControlScreenKt$RemoteControlScreen$8$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">RemoteControlScreenKt$RemoteControlScreen$intentionalPause$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">RemoteControlScreenKt$RemoteControlScreen$speechLaunch$1$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/17)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/86)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package com.penguino.ui.screens
&nbsp;
&nbsp;import android.bluetooth.BluetoothProfile
&nbsp;import android.content.Intent
&nbsp;import android.speech.RecognizerIntent
&nbsp;import androidx.activity.compose.rememberLauncherForActivityResult
&nbsp;import androidx.activity.result.contract.ActivityResultContracts
&nbsp;import androidx.compose.foundation.layout.Arrangement
&nbsp;import androidx.compose.foundation.layout.Column
&nbsp;import androidx.compose.foundation.layout.Row
&nbsp;import androidx.compose.foundation.layout.fillMaxSize
&nbsp;import androidx.compose.foundation.layout.fillMaxWidth
&nbsp;import androidx.compose.foundation.layout.padding
&nbsp;import androidx.compose.material.icons.Icons
&nbsp;import androidx.compose.material.icons.filled.Star
&nbsp;import androidx.compose.material3.Button
&nbsp;import androidx.compose.material3.Icon
&nbsp;import androidx.compose.material3.IconButton
&nbsp;import androidx.compose.material3.MaterialTheme
&nbsp;import androidx.compose.material3.Text
&nbsp;import androidx.compose.runtime.Composable
&nbsp;import androidx.compose.runtime.getValue
&nbsp;import androidx.compose.runtime.mutableStateOf
&nbsp;import androidx.compose.runtime.saveable.rememberSaveable
&nbsp;import androidx.compose.runtime.setValue
&nbsp;import androidx.compose.ui.Alignment
&nbsp;import androidx.compose.ui.Modifier
&nbsp;import androidx.compose.ui.platform.LocalLifecycleOwner
&nbsp;import androidx.compose.ui.tooling.preview.Preview
&nbsp;import androidx.compose.ui.unit.dp
&nbsp;import androidx.lifecycle.Lifecycle
&nbsp;import com.penguino.data.bluetooth.PenguinoGattService
&nbsp;import com.penguino.data.models.PetInformation
&nbsp;import com.penguino.ui.components.Loader
&nbsp;import com.penguino.ui.theme.PenguinoTheme
&nbsp;import com.penguino.ui.viewmodels.RemoteControlViewModel.RemoteControlUiState
&nbsp;import com.penguino.data.utils.ObserveLifecycle
&nbsp;
&nbsp;@Composable
&nbsp;fun RemoteControlScreen(
<b class="nc">&nbsp;	modifier: Modifier = Modifier,</b>
<b class="nc">&nbsp;	uiState: RemoteControlUiState = RemoteControlUiState(PetInformation()),</b>
<b class="nc">&nbsp;	btConnectionState: Int = BluetoothProfile.STATE_CONNECTED,</b>
<b class="nc">&nbsp;	btServiceBind: () -&gt; Unit = {},</b>
<b class="nc">&nbsp;	btServiceUnbind: () -&gt; Unit = {},</b>
<b class="nc">&nbsp;	btConnect: () -&gt; Unit = {},</b>
<b class="nc">&nbsp;	btDisconnect: () -&gt; Unit = {},</b>
<b class="nc">&nbsp;	btMessageSend: (String) -&gt; Unit = {},</b>
<b class="nc">&nbsp;	chatFunc: (String) -&gt; Unit = {},</b>
<b class="nc">&nbsp;) {</b>
&nbsp;	/**
&nbsp;	 * Use this variable to tell the screen when not to disconnect to the device when an
&nbsp;	 * action requires to pause. Check the body of ON_RESUME and ON_PAUSE inside the
&nbsp;	 * ObserveLifecycle composable
&nbsp;	 */
<b class="nc">&nbsp;	var intentionalPause by rememberSaveable {</b>
<b class="nc">&nbsp;		mutableStateOf(false)</b>
&nbsp;	}
&nbsp;
<b class="nc">&nbsp;	ObserveLifecycle(lifecycleOwner = LocalLifecycleOwner.current,</b>
<b class="nc">&nbsp;		observer = { _, event -&gt;</b>
<b class="nc">&nbsp;			when (event) {</b>
<b class="nc">&nbsp;				Lifecycle.Event.ON_CREATE -&gt; btServiceBind()</b>
&nbsp;				Lifecycle.Event.ON_RESUME -&gt; {
<b class="nc">&nbsp;					if (!intentionalPause) {</b>
<b class="nc">&nbsp;						btConnect()</b>
&nbsp;					}
<b class="nc">&nbsp;					intentionalPause = false</b>
&nbsp;				}
&nbsp;
&nbsp;				Lifecycle.Event.ON_PAUSE -&gt; {
<b class="nc">&nbsp;					if (!intentionalPause) {</b>
<b class="nc">&nbsp;						btDisconnect()</b>
&nbsp;					}
&nbsp;				}
&nbsp;
&nbsp;				else -&gt; {}
&nbsp;			}
&nbsp;		},
<b class="nc">&nbsp;		final = {</b>
<b class="nc">&nbsp;			btServiceUnbind()</b>
&nbsp;		}
&nbsp;	)
&nbsp;
<b class="nc">&nbsp;	val speechRecognizerIntent = Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH)</b>
<b class="nc">&nbsp;		.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL, RecognizerIntent.LANGUAGE_MODEL_FREE_FORM)</b>
<b class="nc">&nbsp;		.putExtra(RecognizerIntent.EXTRA_LANGUAGE, &quot;en-US&quot;)</b>
&nbsp;
<b class="nc">&nbsp;	val speechLaunch = rememberLauncherForActivityResult(</b>
<b class="nc">&nbsp;		contract = ActivityResultContracts.StartActivityForResult(),</b>
<b class="nc">&nbsp;		onResult = {</b>
<b class="nc">&nbsp;			it.data?.extras?.getStringArrayList(RecognizerIntent.EXTRA_RESULTS)?.first()</b>
<b class="nc">&nbsp;				?.let { input -&gt;</b>
<b class="nc">&nbsp;					chatFunc(input)</b>
<b class="nc">&nbsp;				}</b>
&nbsp;		})
&nbsp;
<b class="nc">&nbsp;	when (btConnectionState) {</b>
<b class="nc">&nbsp;		PenguinoGattService.STATE_GATT_CONNECTING -&gt; {</b>
<b class="nc">&nbsp;			Column(</b>
<b class="nc">&nbsp;				Modifier.fillMaxSize(),</b>
<b class="nc">&nbsp;				verticalArrangement = Arrangement.Center,</b>
<b class="nc">&nbsp;				horizontalAlignment = Alignment.CenterHorizontally</b>
&nbsp;			) {
<b class="nc">&nbsp;				Loader(text = &quot;Connecting&quot;)</b>
<b class="nc">&nbsp;			}</b>
&nbsp;		}
&nbsp;
<b class="nc">&nbsp;		PenguinoGattService.STATE_GATT_CONNECTED -&gt; {</b>
<b class="nc">&nbsp;			Column(modifier.fillMaxSize()) {</b>
<b class="nc">&nbsp;				Column(</b>
<b class="nc">&nbsp;					modifier = Modifier</b>
<b class="nc">&nbsp;						.fillMaxWidth()</b>
<b class="nc">&nbsp;						.weight(1f),</b>
<b class="nc">&nbsp;					verticalArrangement = Arrangement.Center,</b>
<b class="nc">&nbsp;					horizontalAlignment = Alignment.CenterHorizontally</b>
&nbsp;				) {
<b class="nc">&nbsp;					uiState.latestResponse?.let {</b>
<b class="nc">&nbsp;						Text(text = it.content, color = MaterialTheme.colorScheme.onBackground)</b>
<b class="nc">&nbsp;					}</b>
<b class="nc">&nbsp;				}</b>
&nbsp;
<b class="nc">&nbsp;				Column(</b>
<b class="nc">&nbsp;					modifier = Modifier</b>
<b class="nc">&nbsp;						.fillMaxWidth()</b>
<b class="nc">&nbsp;						.padding(8.dp),</b>
<b class="nc">&nbsp;					horizontalAlignment = Alignment.CenterHorizontally</b>
&nbsp;				) {
<b class="nc">&nbsp;					Row(Modifier.fillMaxWidth(), horizontalArrangement = Arrangement.SpaceEvenly) {</b>
<b class="nc">&nbsp;						Button(onClick = { btMessageSend(&quot;ON&quot;) }) {</b>
&nbsp;							Text(text = &quot;On&quot;)
&nbsp;						}
<b class="nc">&nbsp;						Button(onClick = { btMessageSend(&quot;OFF&quot;) }) {</b>
&nbsp;							Text(text = &quot;Off&quot;)
&nbsp;						}
<b class="nc">&nbsp;					}</b>
<b class="nc">&nbsp;					IconButton(onClick = {</b>
<b class="nc">&nbsp;						intentionalPause = true</b>
<b class="nc">&nbsp;						speechLaunch.launch(speechRecognizerIntent)</b>
&nbsp;					}) {
&nbsp;						Icon(
&nbsp;							imageVector = Icons.Default.Star,
&nbsp;							contentDescription = &quot;Mic&quot;,
&nbsp;							tint = MaterialTheme.colorScheme.onBackground
&nbsp;						)
&nbsp;					}
<b class="nc">&nbsp;				}</b>
<b class="nc">&nbsp;			}</b>
&nbsp;		}
&nbsp;
<b class="nc">&nbsp;		else -&gt; {</b>
<b class="nc">&nbsp;			Column(</b>
<b class="nc">&nbsp;				Modifier.fillMaxSize(),</b>
<b class="nc">&nbsp;				verticalArrangement = Arrangement.Center,</b>
<b class="nc">&nbsp;				horizontalAlignment = Alignment.CenterHorizontally</b>
&nbsp;			) {
<b class="nc">&nbsp;				Text(text = &quot;Cannot connect to device&quot;)</b>
<b class="nc">&nbsp;			}</b>
&nbsp;		}
&nbsp;	}
&nbsp;
&nbsp;
<b class="nc">&nbsp;}</b>
&nbsp;
&nbsp;@Preview
&nbsp;@Composable
<b class="nc">&nbsp;fun PreviewRcScreen() {</b>
<b class="nc">&nbsp;	PenguinoTheme {</b>
&nbsp;		RemoteControlScreen()
&nbsp;	}
<b class="nc">&nbsp;}</b>
&nbsp;
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-08-24 12:14</div>
</div>
</body>
</html>
